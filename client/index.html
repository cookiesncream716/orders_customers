<html>
	<head>
		<title>1955 API</title>
		<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" integrity="sha384-1q8mTJOASx8j1Au+a5WDVnPi2lkFfwwEAa8hDDdjZlpLegxhjVME1fgjWPGmkzs7" crossorigin="anonymous">
		<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js" integrity="sha384-0mSbJDEHialfmuBBQP6A4Qrprq5OVfW37PRR3j5ELqxss1yVqOtnepnHVP9aJ7xS" crossorigin="anonymous"></script>
		<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap-theme.min.css" integrity="sha384-fLW2N01lMqjakBkx3l/M9EahuwpSfeNvV63J5ezn3uZzapT0u7EYsXMjQV+0En5r" crossorigin="anonymous">
		 <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/angularjs/1.3.5/angular.min.js"></script>
		 <script src="//ajax.googleapis.com/ajax/libs/angularjs/1.3.5/angular-route.min.js"></script>
		 <script>
		 	var myApp = angular.module('myApp', ['ngRoute']);

		 	myApp.config(function($routeProvider){
		 		$routeProvider
		 			.when('/', {
		 				templateUrl: 'partials/orders.html'
		 			})
		 			.when('/customers', {
		 				templateUrl: 'partials/customers.html'
		 			})
		 			.otherwise({
		 				redirectTo: '/'
		 			});
		 	});

		 	myApp.factory('customerFactory', function($http){
		 		var customers = [];
		 		var factory = {};
		 		factory.index = function(callback){
		 			$http.get('/customers').success(function(output){
		 				customers = output;
		 				callback(customers);
		 			});
		 		};
		 		factory.create = function(customer, callback){
		 			$http.post('/customers', customer).success(function(output){
		 				callback();
		 			});
		 		};
		 		factory.destroy = function(index, callback){
		 			var id = customers[index]._id;
		 			$http.delete('/customers/' + id).success(function(output){
		 				callback();
		 			});
		 		};
		 		return factory;
		 	});

		 	myApp.factory('orderFactory', function($http){
		 		var orders = [];
		 		var factory = {};
		 		factory.index = function(callback){
		 			$http.get('/orders').success(function(output){
		 				orders = output;
		 				callback(orders);
		 			});
		 		};
		 		factory.create = function(order, callback){
		 			$http.post('/orders', order).success(function(output){
		 				callback();
		 			});
		 		};
		 		return factory;
		 	});

		 	myApp.controller('customersController', function($scope, customerFactory){
		 		customerFactory.index(function(data){
		 			$scope.customers = data;
		 		})
		 		$scope.createCustomer = function(){
		 			customerFactory.create($scope.newCustomer, function(data){
		 				$scope.newCustomer = {};
		 				customerFactory.index(function(data){
		 					$scope.customers = data;
		 				});
		 			});
		 		};
		 		$scope.deleteCustomer = function($index){
		 			customerFactory.destroy($index, function(data){
		 				customerFactory.index(function(data){
		 					$scope.customers = data;
		 				});
		 			});
		 		};
		 	});

		 	myApp.controller('ordersController', function($scope, orderFactory, customerFactory){
		 		$scope.products = ['flip flops', 'Nike running shoes', 'black sandals', 'cowboy boots', 'slippers', 'pink heels'];
		 		customerFactory.index(function(data){
		 			$scope.customers = data;
		 		});
		 		orderFactory.index(function(data){
		 			// console.log('got orders' + data);
		 			$scope.orders = data;
		 		});
		 		$scope.createOrder = function(){
		 			// console.log($scope.newOrder.customer)
		 			orderFactory.create($scope.newOrder, function(data){
		 				$scope.newOrder = {};
		 				orderFactory.index(function(data){
		 					$scope.orders = data;
		 				});
		 			});
		 		}
		 	});

		 </script>
	</head>
	<body ng-app='myApp'>
		<div class='container'>
			 <a href="#/">Orders</a> | <a href="#/customers">Customers</a>
			<div ng-view=''>
			</div>
		</div>
	</body>
</html>